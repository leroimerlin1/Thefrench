<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>The French Cali Farmz</title>
  
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&display=swap');

    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: 'Orbitron', sans-serif;
      background:#000;
      color:#e0ffe0;
      min-height:100vh;
      overflow-x:hidden;
    }
    .container {
      position:relative;
      min-height:100vh;
      background:url('https://images.unsplash.com/photo-1557683316-973673baf926?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80') center/cover no-repeat fixed;
    }
    .overlay {
      position:absolute;
      inset:0;
      background:rgba(0,0,0,0.78);
      backdrop-filter:blur(1.5px);
      z-index:1;
    }
    .content {
      position:relative;
      z-index:2;
      min-height:100vh;
    }

    header {
      position:sticky;
      top:0;
      background:rgba(0,0,0,0.75);
      backdrop-filter:blur(10px);
      padding:10px 16px;
      border-bottom:1px solid rgba(57,255,20,0.35);
      z-index:10;
      display:flex;
      align-items:center;
      justify-content:space-between;
    }
    .back-btn {
      background:rgba(57,255,20,0.15);
      color:#39ff14;
      border:1px solid #39ff14;
      padding:8px 14px;
      border-radius:8px;
      font-weight:bold;
      cursor:pointer;
    }
    h1 {
      font-size:1.35rem;
      font-weight:900;
      letter-spacing:1.5px;
      color:#39ff14;
      text-shadow:0 0 12px rgba(57,255,20,0.7);
    }

    .welcome, .filters {
      padding:14px 16px;
      background:rgba(0,0,0,0.5);
      border-bottom:1px solid rgba(57,255,20,0.3);
    }
    .filters {
      display:flex;
      gap:12px;
    }
    .filter-btn {
      flex:1;
      padding:10px;
      background:rgba(57,255,20,0.15);
      border:1px solid #39ff14;
      border-radius:8px;
      color:#39ff14;
      font-weight:bold;
      cursor:pointer;
      text-align:center;
    }
    .filter-btn.active {
      background:#39ff14;
      color:#000;
    }

    #products-list, #category-list, #farm-list {
      padding:16px;
      padding-bottom:100px;
    }
    #category-list, #farm-list {
      display:none;
    }
    .list-item {
      background:rgba(15,25,15,0.7);
      border:1px solid rgba(57,255,20,0.4);
      border-radius:10px;
      padding:14px;
      margin-bottom:12px;
      cursor:pointer;
      font-size:1.1rem;
      font-weight:bold;
      transition:0.2s;
    }
    .list-item:hover {
      background:#39ff14;
      color:#000;
      transform:translateX(6px);
    }

    .card { /* style grille produits comme avant */ 
      background:rgba(15,25,15,0.65);
      border:1px solid rgba(57,255,20,0.35);
      border-radius:10px;
      overflow:hidden;
      backdrop-filter:blur(5px);
      transition:all 0.2s;
      cursor:pointer;
      margin-bottom:16px;
    }
    .card:hover { transform:scale(1.03); border-color:#39ff14; }
    .card-img { height:170px; position:relative; }
    .card-img img { width:100%; height:100%; object-fit:cover; }
    .badge-star {
      position:absolute; top:6px; left:6px;
      background:#39ff14; color:#000; font-size:0.65rem; padding:3px 8px; border-radius:999px; font-weight:bold;
    }
    .badge-farm {
      position:absolute; bottom:6px; right:6px;
      background:rgba(0,0,0,0.75); color:#39ff14; font-size:0.7rem; padding:4px 9px; border-radius:6px;
    }
    .card-body { padding:10px; }
    .card-title { font-size:1rem; color:#fff; margin-bottom:3px; font-weight:700; }
    .card-info { font-size:0.75rem; color:#aaffaa; }

    /* Page d√©tail (comme avant) */
    #product-detail { display:none; padding:0 0 100px 0; }
    .product-hero { height:260px; position:relative; }
    .product-hero img { width:100%; height:100%; object-fit:cover; }
    .product-title { padding:16px; font-size:1.5rem; font-weight:900; color:#39ff14; text-shadow:0 0 10px rgba(57,255,20,0.6); }
    .badges { padding:0 16px 12px; display:flex; flex-wrap:wrap; gap:8px; }
    .badge { padding:6px 12px; border-radius:999px; font-size:0.85rem; font-weight:bold; }
    .badge-strain { background:rgba(57,255,20,0.2); color:#39ff14; border:1px solid #39ff14; }
    .badge-farm { background:rgba(0,80,0,0.4); color:#aaffaa; border:1px solid #39ff14; }
    .info-diamond { padding:0 16px 16px; color:#39ff14; font-size:0.9rem; }
    .quantity-section { padding:16px; background:rgba(0,0,0,0.5); margin:12px 16px; border-radius:12px; border:1px solid rgba(57,255,20,0.4); }
    .quantity-title { font-size:1.1rem; color:#39ff14; margin-bottom:12px; display:flex; align-items:center; gap:8px; }
    .quantity-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:10px; }
    .qty-btn {
      background:rgba(57,255,20,0.15); border:1px solid #39ff14; color:#fff;
      padding:12px 8px; border-radius:10px; text-align:center; cursor:pointer; font-weight:bold; transition:0.2s; line-height:1.3;
    }
    .qty-btn:hover, .qty-btn.selected { background:#39ff14; color:#000; }
    .add-to-cart {
      margin:16px; background:#39ff14; color:#000; border:none; padding:16px; font-size:1.1rem; font-weight:bold;
      border-radius:12px; display:flex; align-items:center; justify-content:center; gap:10px; cursor:pointer;
      box-shadow:0 0 15px rgba(57,255,20,0.5);
    }

    nav {
      position:fixed; bottom:0; left:0; right:0;
      background:rgba(5,15,5,0.92); backdrop-filter:blur(14px);
      border-top:1px solid rgba(57,255,20,0.25); padding:8px 0;
      display:flex; justify-content:space-around; z-index:20;
    }
    .nav-item {
      display:flex; flex-direction:column; align-items:center;
      color:#88ff88; font-size:0.7rem; gap:3px; cursor:pointer;
    }
    .nav-item.active { color:#39ff14; }
  </style>
</head>
<body>

<div class="container">
  <div class="overlay"></div>
  <div class="content">

    <header id="main-header">
      <button class="back-btn" id="btn-back" style="display:none;">‚Üê Retour</button>
      <h1 id="page-title">The French Cali Farmz</h1>
      <div id="user-info"></div>
    </header>

    <!-- Accueil -->
    <div id="home-page">
      <section class="welcome">
        <div class="welcome-inner">
          <div class="welcome-emoji">üëã</div>
          <div>
            <h2 id="welcome-name">Chargement...</h2>
            <p>Bienvenue sur le shop premium</p>
          </div>
        </div>
      </section>

      <div class="filters">
        <button class="filter-btn" id="btn-categories">Cat√©gories</button>
        <button class="filter-btn" id="btn-farms">Farms</button>
      </div>

      <!-- Grille produits normale -->
      <div id="products-grid">
        <div class="card" data-key="cali" data-title="Caliplatesüá∫üá∏" data-farm="Frozen Single Source üá∫üá∏">
          <div class="card-img"><img src="caliplates.jpg" alt="Caliplates"></div>
          <div class="badge-star">‚òÖ</div>
          <div class="badge-farm">Frozen Single Source üá∫üá∏</div>
          <div class="card-body">
            <div class="card-title">Caliplatesüá∫üá∏</div>
            <div class="card-info">Frozen Single Source üá∫üá∏</div>
          </div>
        </div>

        <div class="card" data-key="35u" data-title="35u KGFü¶ä" data-farm="KGF ü¶ä">
          <div class="card-img"><img src="35u.jpg" alt="35u KGF"></div>
          <div class="badge-star">‚òÖ</div>
          <div class="badge-farm">KGF ü¶ä</div>
          <div class="card-body">
            <div class="card-title">35u KGFü¶ä</div>
            <div class="card-info">KGF ü¶ä</div>
          </div>
        </div>
      </div>

      <!-- Liste Cat√©gories (titres) -->
      <div id="category-list"></div>

      <!-- Liste Farms (sous-titres) -->
      <div id="farm-list"></div>
    </div>

    <!-- D√©tail produit (comme avant) -->
    <div id="product-detail" style="display:none;">
      <div class="product-hero"><img id="detail-img" src="" alt="Produit"></div>
      <div class="product-title" id="detail-title"></div>
      <div class="badges">
        <div class="badge badge-strain" id="detail-strain"></div>
        <div class="badge badge-farm" id="detail-farm"></div>
      </div>
      <div class="info-diamond" id="detail-info"></div>
      <div class="quantity-section">
        <div class="quantity-title"><span>üõçÔ∏è</span> S√©lectionner la Quantit√©</div>
        <div class="quantity-grid" id="qty-grid"></div>
      </div>
      <button class="add-to-cart" id="add-to-cart-btn"><span>üõí</span> Ajouter au Panier</button>
    </div>

    <nav>
      <div class="nav-item active" id="nav-home">üè†<span>Accueil</span></div>
      <div class="nav-item">‚≠ê<span>Avis</span></div>
      <div class="nav-item" id="nav-cart">üõí<span>Panier</span></div>
      <div class="nav-item">‚ÑπÔ∏è<span>Infos</span></div>
      <div class="nav-item">‚úâÔ∏è<span>Contact</span></div>
    </nav>

  </div>
</div>

<script>
  const tg = window.Telegram.WebApp;
  tg.ready();
  tg.expand();

  const user = tg.initDataUnsafe?.user;
  if (user) {
    document.getElementById('welcome-name').textContent = `Salut ${user.first_name || 'Farmer'} !`;
    document.getElementById('user-info').textContent = `@${user.username || 'anonyme'}`;
  } else {
    document.getElementById('welcome-name').textContent = 'Bienvenue !';
  }

  const products = {
    cali: {
      title: 'Caliplatesüá∫üá∏',
      farm: 'Frozen Single Source üá∫üá∏',
      img: 'caliplates.jpg',
      strain: 'Frozen Single Source üá∫üá∏',
      info: '‚óÜ frozen single source üá∫üá∏',
      quantities: [
        { qty: '0.5g', price: '40 ‚Ç¨' },
        { qty: '1g',   price: '80 ‚Ç¨' },
        { qty: '2g',   price: '130 ‚Ç¨' },
        { qty: '5g',   price: '280 ‚Ç¨' },
        { qty: '10g',  price: '500 ‚Ç¨' },
        { qty: '20g',  price: '950 ‚Ç¨' }
      ]
    },
    '35u': {
      title: '35u KGFü¶ä',
      farm: 'KGF ü¶ä',
      img: '35u.jpg',
      strain: 'KGF ü¶ä',
      info: '‚óÜ KGF ü¶ä',
      quantities: [
        { qty: '5g',   price: '30 ‚Ç¨' },
        { qty: '10g',  price: '60 ‚Ç¨' },
        { qty: '25g',  price: '100 ‚Ç¨' },
        { qty: '50g',  price: '180 ‚Ç¨' },
        { qty: '100g', price: '350 ‚Ç¨' },
        { qty: '500g', price: '1600 ‚Ç¨' },
        { qty: '1000g',price: '3200 ‚Ç¨' }
      ]
    }
  };

  // Ouvrir d√©tail depuis grille normale
  document.querySelectorAll('#products-grid .card').forEach(card => {
    card.addEventListener('click', () => openProductDetail(card.dataset.key));
  });

  function openProductDetail(key) {
    const p = products[key];
    if (!p) return;

    document.getElementById('detail-img').src = p.img;
    document.getElementById('detail-title').textContent = p.title;
    document.getElementById('detail-strain').textContent = p.strain;
    document.getElementById('detail-farm').textContent = p.farm;
    document.getElementById('detail-info').textContent = p.info;

    const grid = document.getElementById('qty-grid');
    grid.innerHTML = '';
    p.quantities.forEach((item, idx) => {
      const btn = document.createElement('button');
      btn.className = 'qty-btn';
      btn.innerHTML = `${item.qty}<br>${item.price}`;
      btn.onclick = () => {
        grid.querySelectorAll('.qty-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
      };
      grid.appendChild(btn);
    });

    document.getElementById('home-page').style.display = 'none';
    document.getElementById('product-detail').style.display = 'block';
    document.getElementById('btn-back').style.display = 'inline-block';
    document.getElementById('page-title').textContent = p.title;
  }

  // Bouton Retour
  document.getElementById('btn-back').onclick = () => {
    document.getElementById('home-page').style.display = 'block';
    document.getElementById('product-detail').style.display = 'none';
    document.getElementById('category-list').style.display = 'none';
    document.getElementById('farm-list').style.display = 'none';
    document.getElementById('products-grid').style.display = 'block';
    document.getElementById('btn-back').style.display = 'none';
    document.getElementById('page-title').textContent = 'The French Cali Farmz';

    // Reset boutons filtres
    document.getElementById('btn-categories').classList.remove('active');
    document.getElementById('btn-farms').classList.remove('active');
  };

  // Filtre Cat√©gories ‚Üí montre les TITRES
  document.getElementById('btn-categories').onclick = function() {
    this.classList.toggle('active');
    document.getElementById('btn-farms').classList.remove('active');

    if (this.classList.contains('active')) {
      document.getElementById('products-grid').style.display = 'none';
      document.getElementById('farm-list').style.display = 'none';
      const catList = document.getElementById('category-list');
      catList.style.display = 'block';
      catList.innerHTML = '';

      Object.keys(products).forEach(key => {
        const p = products[key];
        const div = document.createElement('div');
        div.className = 'list-item';
        div.textContent = p.title;
        div.onclick = () => openProductDetail(key);
        catList.appendChild(div);
      });
    } else {
      document.getElementById('category-list').style.display = 'none';
      document.getElementById('products-grid').style.display = 'block';
    }
  };

  // Filtre Farms ‚Üí montre les FARMS / sous-titres
  document.getElementById('btn-farms').onclick = function() {
    this.classList.toggle('active');
    document.getElementById('btn-categories').classList.remove('active');

    if (this.classList.contains('active')) {
      document.getElementById('products-grid').style.display = 'none';
      document.getElementById('category-list').style.display = 'none';
      const farmList = document.getElementById('farm-list');
      farmList.style.display = 'block';
      farmList.innerHTML = '';

      Object.keys(products).forEach(key => {
        const p = products[key];
        const div = document.createElement('div');
        div.className = 'list-item';
        div.textContent = p.farm;
        div.onclick = () => openProductDetail(key);
        farmList.appendChild(div);
      });
    } else {
      document.getElementById('farm-list').style.display = 'none';
      document.getElementById('products-grid').style.display = 'block';
    }
  };

  // Ajouter au panier (simulation, comme avant)
  document.getElementById('add-to-cart-btn').onclick = () => {
    alert('Produit ajout√© au panier !');
  };
</script>

</body>
</html>
